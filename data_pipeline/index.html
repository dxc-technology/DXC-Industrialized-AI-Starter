<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Data Pipeline - DXC Industrialized AI Starter</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  <link href="../extra.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Data Pipeline";
    var mkdocs_page_input_path = "data_pipeline.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> DXC Industrialized AI Starter</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Welcome</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../access_data/">Access Data</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../clean_data/">Clean Data</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../explore/">Visualization</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Data Pipeline</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#insert-data-into-mongodb">Insert data into MongoDB</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#build-pipeline">Build Pipeline</a>
    </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../experiment/">Experiment</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../model_explainability/">Model Explainability</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../publish_microservice/">Publish Microservice</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../logging/">Logging</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../data_sets/">Load Data</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../reinforcement_learning/">Reinforcement Learning</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../contributing_guide/">How to Contribute</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">DXC Industrialized AI Starter</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Data Pipeline</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="build-data-pipelines">Build Data Pipelines</h1>
<hr />
<h2 id="insert-data-into-mongodb">Insert data into MongoDB</h2>
<p>Pipelines are a standard way to process your data towards modeling and interpreting. By default, the DXC AI Starter library uses the free tier of <a href="https://account.mongodb.com/account/register">MongoDB Atlas</a> to store raw data and execute pipelines. This code defines the meta-data needed to connect to Mongo DB Atlas and create a new datastore cluster. This is where you define basic information about the location of the cluster and the collection and database to use. Update this code with information appropriate to your project. To provide the information required in data_layer, you must:</p>
<ul>
<li>Create a <a href="https://account.mongodb.com/account/login" target="_blank"> MongoDb </a> Atlas account</li>
<li>Create a cluster</li>
<li>Create a user</li>
<li>Generate a connection string</li>
</ul>
<p><strong>Note:</strong> When you configure the IP whitelist for your cluster, choose to allow a connection from anywhere. When creating the database connection string, choose the Python driver version 3.4 or later.</p>
<p>Example:</p>
<pre><code class="python">data_layer = {
    &quot;connection_string&quot;: &quot;&lt;your connection_string&gt;&quot;,
    &quot;collection_name&quot;: &quot;&lt;your collection_name&gt;&quot;,
    &quot;database_name&quot;: &quot;&lt;your database_name&gt;&quot;,
    &quot;data_source&quot;:&quot;&lt;Source of your datset&gt;&quot;,
    &quot;cleaner&quot;:&quot;&lt;whether applied cleaner yes/no &gt;&quot;
}

wrt_raw_data = ai.write_raw_data(data_layer, raw_data, date_fields = [])
</code></pre>

<p><strong>ai.write_raw_data(data_layer, raw_data, date_fields = [ ]):</strong> </p>
<ul>
<li>This function handles Mongo DB Atlas automatically.</li>
<li>Use write_raw_data function from ai library to convert Arrow dates to Strings data types</li>
<li>It also transfers the raw data into the database and collection.</li>
<li>It also stores metadata details, which is created as a separate collection, and it stores the information about each version along with their time of insertion.</li>
</ul>
<p><strong>Version control in Mongo DB:</strong></p>
<p>DXC AI Starter is being equipped with the version control functionality, wherein the documents(data frames) inserted into the mongo are saved automatically as versions. The latest version is always in sync with the retrieved document. The versions are made with an underscore(_) and a number that is directly proportional to the number of times the document is changed. This helps in retrieving back the previous versions of the data.</p>
<h2 id="build-pipeline">Build Pipeline</h2>
<hr />
<p>Once raw data is stored, you can run pipelines to transform the data. Please refer to the syntax of <a href="https://docs.mongodb.com/manual/core/aggregation-pipeline/">MongDB pipelines</a> for the details of how to write a pipeline. Below is an example of creating and executing a pipeline.</p>
<pre><code>pipeline = [
        {
            '$group':{
                '_id': {
                    &quot;funding_source&quot;:&quot;$funding_source&quot;,
                    &quot;request_type&quot;:&quot;$request_type&quot;,
                    &quot;department_name&quot;:&quot;$department_name&quot;,
                    &quot;replacement_body_style&quot;:&quot;$replacement_body_style&quot;,
                    &quot;equipment_class&quot;:&quot;$equipment_class&quot;,
                    &quot;replacement_make&quot;:&quot;$replacement_make&quot;,
                    &quot;replacement_model&quot;:&quot;$replacement_model&quot;,
                    &quot;procurement_plan&quot;:&quot;$procurement_plan&quot;
                    },
                &quot;avg_est_unit_cost&quot;:{&quot;$avg&quot;:&quot;$est_unit_cost&quot;},
                &quot;avg_est_unit_cost_error&quot;:{&quot;$avg&quot;:{ &quot;$subtract&quot;: [ &quot;$est_unit_cost&quot;, &quot;$actual_unit_cost&quot; ] }}
            }
        }
]

df = ai.access_data_from_pipeline(wrt_raw_data, pipeline)
</code></pre>

<ul>
<li><strong>ai.access_data_from_pipeline(write_raw_data, pipeline):</strong> This function instructs the datastore on how to refine the output of raw data into something that can be used to train a machine-learning model. The refined data will be stored in the df Pandas data frame. Make sure the output is what you want before continuing.</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../experiment/" class="btn btn-neutral float-right" title="Experiment">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../explore/" class="btn btn-neutral" title="Visualization"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../explore/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../experiment/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
